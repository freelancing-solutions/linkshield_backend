# Application Configuration
APP_NAME=LinkShield API
APP_VERSION=1.0.0
ENVIRONMENT=development
DEBUG=true
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=1

# Security
SECRET_KEY=your-super-secret-key-change-this-in-production
JWT_SECRET_KEY=your-jwt-secret-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
PASSWORD_RESET_TOKEN_EXPIRE_HOURS=1
EMAIL_VERIFICATION_TOKEN_EXPIRE_HOURS=24

# Database Configuration
DATABASE_URL=postgresql://linkshield_user:password@localhost:5432/linkshield_db
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# Redis Configuration
# SECURITY CRITICAL: Redis is used for distributed rate limiting and session storage
# Ensure Redis is properly secured with authentication and network isolation
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your-redis-password-change-in-production
REDIS_DB=0
REDIS_MAX_CONNECTIONS=10
# Connection timeout for Redis operations (prevents hanging connections)
REDIS_CONNECTION_TIMEOUT=5
# Socket timeout for Redis operations (prevents slow operations from blocking)
REDIS_SOCKET_TIMEOUT=5
# Enable Redis SSL/TLS for production deployments
REDIS_SSL_ENABLED=false
REDIS_SSL_CERT_REQS=required

# Distributed Rate Limiting Configuration
# SECURITY CRITICAL: These settings prevent abuse and DoS attacks
RATE_LIMIT_ENABLED=true
# Global rate limiting - requests per minute per IP address
RATE_LIMIT_REQUESTS_PER_MINUTE=60
# Burst allowance for legitimate traffic spikes
RATE_LIMIT_BURST_SIZE=10
# Rate limit storage backend (redis for distributed, memory for single instance)
RATE_LIMIT_STORAGE_BACKEND=redis
# Rate limit key prefix to avoid collisions with other applications
RATE_LIMIT_KEY_PREFIX=linkshield:ratelimit:
# Rate limit window sliding behavior (true for sliding window, false for fixed window)
RATE_LIMIT_SLIDING_WINDOW=true
# Per-user authenticated rate limits (higher than anonymous)
RATE_LIMIT_AUTHENTICATED_MULTIPLIER=5
# API key rate limits (separate from user limits)
RATE_LIMIT_API_KEY_REQUESTS_PER_MINUTE=300

# SSRF Protection Configuration
# SECURITY CRITICAL: Prevents Server-Side Request Forgery attacks
SSRF_PROTECTION_ENABLED=true
# Block requests to private IP ranges (RFC 1918, RFC 3927, etc.)
SSRF_BLOCK_PRIVATE_IPS=true
# Block requests to localhost and loopback addresses
SSRF_BLOCK_LOCALHOST=true
# Block requests to metadata services (AWS, GCP, Azure)
SSRF_BLOCK_METADATA_SERVICES=true
# Allowed protocols for URL validation (comma-separated)
SSRF_ALLOWED_PROTOCOLS=http,https
# Maximum number of redirects to follow during URL analysis
SSRF_MAX_REDIRECTS=5
# Timeout for external URL requests (prevents hanging requests)
SSRF_REQUEST_TIMEOUT=30
# User agent string for external requests (helps with rate limiting by services)
SSRF_USER_AGENT=LinkShield-Scanner/1.0
# Custom blocked domains (comma-separated, supports wildcards)
SSRF_BLOCKED_DOMAINS=
# Custom allowed domains (if set, only these domains are allowed)
SSRF_ALLOWED_DOMAINS=

# Error Message Standardization
# SECURITY CRITICAL: Prevents information disclosure through error messages
ERROR_STANDARDIZATION_ENABLED=true
# Generic error message for authentication failures (prevents user enumeration)
ERROR_AUTH_GENERIC_MESSAGE=Invalid credentials provided
# Generic error message for authorization failures
ERROR_AUTHZ_GENERIC_MESSAGE=Access denied
# Generic error message for validation failures
ERROR_VALIDATION_GENERIC_MESSAGE=Invalid input provided
# Generic error message for rate limiting
ERROR_RATE_LIMIT_MESSAGE=Too many requests. Please try again later
# Whether to log detailed errors server-side while showing generic messages to users
ERROR_DETAILED_LOGGING=true
# Whether to include error codes in responses (useful for client debugging)
ERROR_INCLUDE_CODES=true
# Whether to include request IDs in error responses (for support tracking)
ERROR_INCLUDE_REQUEST_ID=true

# External API Keys
# VirusTotal API
VIRUSTOTAL_API_KEY=your-virustotal-api-key

# Google Safe Browsing API
GOOGLE_SAFE_BROWSING_API_KEY=your-google-safe-browsing-api-key

# URLVoid API
URLVOID_API_KEY=your-urlvoid-api-key

# OpenAI API
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_MAX_TOKENS=1000

# Email Configuration (Resend)
RESEND_API_KEY=re_your-resend-api-key
EMAIL_FROM=noreply@linkshield.com
EMAIL_FROM_NAME=LinkShield
EMAIL_REPLY_TO=support@linkshield.com

# Email Templates Configuration
EMAIL_TEMPLATE_DIR=src/services/email_templates
EMAIL_BASE_URL=https://linkshield.com
APP_URL=https://linkshield.com

# Email Rate Limiting
EMAIL_RATE_LIMIT_PER_HOUR=100
EMAIL_RATE_LIMIT_PER_DAY=1000

# Legacy SMTP Configuration (fallback - optional)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_TLS=true
# SMTP_SSL=false

# Stripe Configuration (for subscriptions)
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-stripe-webhook-secret

# Webhook Configuration
WEBHOOK_SECRET=your-webhook-secret-key
WEBHOOK_TIMEOUT=30

# File Upload Configuration
MAX_FILE_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES=.txt,.json,.csv
UPLOAD_DIR=./uploads

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=logs/linkshield.log
LOG_ROTATION=1 day
LOG_RETENTION=30 days

# Monitoring
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30

# CORS Configuration
CORS_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# Celery Configuration (Background Tasks)
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC

# AI Analysis Configuration
AI_ANALYSIS_ENABLED=true
AI_ANALYSIS_TIMEOUT=30
AI_BATCH_SIZE=10
AI_CONFIDENCE_THRESHOLD=0.7

# Security Scanning Configuration
SCAN_TIMEOUT=60
SCAN_MAX_RETRIES=3
SCAN_BATCH_SIZE=5
SCAN_PARALLEL_REQUESTS=3

# Subscription Limits
FREE_TIER_DAILY_LIMIT=100
PRO_TIER_DAILY_LIMIT=1000
ENTERPRISE_TIER_DAILY_LIMIT=10000

# Cache Configuration
CACHE_TTL=3600  # 1 hour
CACHE_MAX_SIZE=1000
CACHE_ENABLED=true

# Development/Testing
TEST_DATABASE_URL=postgresql://linkshield_user:password@localhost:5432/linkshield_test_db
TEST_MODE=false
MOCK_EXTERNAL_APIS=false

# ========================================
# PHASE 2 SECURITY CONFIGURATION
# ========================================
# These settings enhance security through comprehensive validation,
# session management, access control, audit logging, and policy enforcement

# Email Validation Settings (Phase 2 Security Enhancement)
# SECURITY CRITICAL: Multi-layer email validation prevents abuse and improves data quality
LINKSHIELD_EMAIL_VALIDATION_ENABLED=true
LINKSHIELD_EMAIL_MX_CHECK_ENABLED=true
LINKSHIELD_EMAIL_MX_CHECK_TIMEOUT=10
LINKSHIELD_EMAIL_DISPOSABLE_CHECK_ENABLED=true
LINKSHIELD_EMAIL_DISPOSABLE_API_KEY=
LINKSHIELD_EMAIL_DOMAIN_BLACKLIST=
LINKSHIELD_EMAIL_DOMAIN_WHITELIST=
LINKSHIELD_EMAIL_REGEX_STRICT=true
LINKSHIELD_EMAIL_NORMALIZE_ENABLED=true
LINKSHIELD_EMAIL_TYPO_DETECTION=true
LINKSHIELD_EMAIL_ROLE_ACCOUNT_BLOCK=false
LINKSHIELD_EMAIL_VALIDATION_CACHE_TTL=3600

# Session Management Settings (Phase 2 Security Enhancement)
# SECURITY CRITICAL: Addresses session duration mismatches and security policy enforcement
LINKSHIELD_SESSION_DURATION_DAYS=7
LINKSHIELD_SESSION_MAX_IDLE_HOURS=24
LINKSHIELD_SESSION_MAX_CONCURRENT_SESSIONS=5
LINKSHIELD_SESSION_REQUIRE_FRESH_LOGIN_HOURS=168
LINKSHIELD_SESSION_SECURE_COOKIE=true
LINKSHIELD_SESSION_HTTPONLY_COOKIE=true
LINKSHIELD_SESSION_SAMESITE_COOKIE=Strict
LINKSHIELD_SESSION_INVALIDATE_ON_PASSWORD_CHANGE=true
LINKSHIELD_SESSION_TRACK_IP_CHANGES=true
LINKSHIELD_SESSION_TRACK_USER_AGENT_CHANGES=true
LINKSHIELD_SESSION_CLEANUP_INTERVAL_HOURS=1
LINKSHIELD_SESSION_EXTEND_ON_ACTIVITY=true
LINKSHIELD_SESSION_NOTIFICATION_ON_NEW_LOGIN=true

# Access Control Settings (Phase 2 Security Enhancement)
# SECURITY CRITICAL: Addresses anonymous user limits and subscription tier enforcement
LINKSHIELD_ANONYMOUS_DAILY_LIMIT=5
LINKSHIELD_ANONYMOUS_HOURLY_LIMIT=2
LINKSHIELD_ANONYMOUS_RATE_LIMIT_WINDOW=3600
LINKSHIELD_ANONYMOUS_REQUIRE_CAPTCHA=true
LINKSHIELD_ANONYMOUS_BLOCK_AFTER_ATTEMPTS=10
LINKSHIELD_ANONYMOUS_BLOCK_DURATION_HOURS=24
LINKSHIELD_SUBSCRIPTION_TIER_ENFORCEMENT=true
LINKSHIELD_SUBSCRIPTION_GRACE_PERIOD_DAYS=3
LINKSHIELD_SUBSCRIPTION_DOWNGRADE_IMMEDIATE=false
LINKSHIELD_SUBSCRIPTION_USAGE_RESET_HOUR=0
LINKSHIELD_SUBSCRIPTION_OVERAGE_ALLOWED=false
LINKSHIELD_SUBSCRIPTION_OVERAGE_LIMIT_PERCENT=10
LINKSHIELD_API_KEY_REQUIRED_FOR_ANONYMOUS=false
LINKSHIELD_API_KEY_RATE_LIMIT_MULTIPLIER=2.0
LINKSHIELD_API_ENDPOINT_ACCESS_CONTROL=true
LINKSHIELD_API_ADMIN_ENDPOINTS_REQUIRE_2FA=true

# Audit Logging Configuration (Phase 2 Security Enhancement)
# SECURITY CRITICAL: Comprehensive audit trail requirements and log sanitization
LINKSHIELD_AUDIT_LOG_ENABLED=true
LINKSHIELD_AUDIT_LOG_FILE=logs/audit.log
LINKSHIELD_AUDIT_LOG_LEVEL=INFO
LINKSHIELD_AUDIT_LOG_RETENTION_DAYS=365
LINKSHIELD_AUDIT_LOG_ROTATION_SIZE=100MB
LINKSHIELD_AUDIT_LOG_MAX_FILES=10
LINKSHIELD_AUDIT_LOG_USER_ACTIONS=true
LINKSHIELD_AUDIT_LOG_ADMIN_ACTIONS=true
LINKSHIELD_AUDIT_LOG_API_CALLS=true
LINKSHIELD_AUDIT_LOG_AUTHENTICATION=true
LINKSHIELD_AUDIT_LOG_AUTHORIZATION_FAILURES=true
LINKSHIELD_AUDIT_LOG_DATA_ACCESS=true
LINKSHIELD_AUDIT_LOG_CONFIGURATION_CHANGES=true
LINKSHIELD_AUDIT_LOG_SANITIZE_PII=true
LINKSHIELD_AUDIT_LOG_MASK_SENSITIVE_DATA=true
LINKSHIELD_AUDIT_LOG_INCLUDE_REQUEST_BODY=false
LINKSHIELD_AUDIT_LOG_INCLUDE_RESPONSE_BODY=false
LINKSHIELD_AUDIT_LOG_IP_ANONYMIZATION=true
LINKSHIELD_AUDIT_LOG_COMPLIANCE_MODE=false
LINKSHIELD_AUDIT_LOG_EXPORT_FORMAT=json
LINKSHIELD_AUDIT_LOG_INTEGRITY_CHECK=true

# Security Policy Settings (Phase 2 Security Enhancement)
# SECURITY CRITICAL: Comprehensive security policy enforcement and compliance requirements
LINKSHIELD_SECURITY_POLICY_ENFORCEMENT=true
LINKSHIELD_SECURITY_POLICY_STRICT_MODE=false
LINKSHIELD_SECURITY_POLICY_AUDIT_MODE=true
LINKSHIELD_INPUT_VALIDATION_STRICT=true
LINKSHIELD_INPUT_VALIDATION_MAX_LENGTH=10000
LINKSHIELD_INPUT_VALIDATION_ALLOW_HTML=false
LINKSHIELD_INPUT_VALIDATION_SANITIZE_SQL=true
LINKSHIELD_INPUT_VALIDATION_BLOCK_SCRIPTS=true
LINKSHIELD_INPUT_VALIDATION_ENCODING_CHECK=true
LINKSHIELD_CSP_ENABLED=true
LINKSHIELD_CSP_REPORT_ONLY=false
LINKSHIELD_CSP_REPORT_URI=
LINKSHIELD_CSP_SCRIPT_SRC='self'
LINKSHIELD_CSP_STYLE_SRC='self' 'unsafe-inline'
LINKSHIELD_CSP_IMG_SRC='self' data: https:
LINKSHIELD_GDPR_COMPLIANCE_MODE=false
LINKSHIELD_CCPA_COMPLIANCE_MODE=false
LINKSHIELD_SOC2_COMPLIANCE_MODE=false
LINKSHIELD_DATA_RETENTION_POLICY_DAYS=2555
LINKSHIELD_DATA_ANONYMIZATION_ENABLED=true
LINKSHIELD_DATA_EXPORT_ENCRYPTION=true
LINKSHIELD_SECURITY_HEADERS_ENABLED=true
LINKSHIELD_HSTS_ENABLED=true
LINKSHIELD_HSTS_MAX_AGE=31536000
LINKSHIELD_HSTS_INCLUDE_SUBDOMAINS=true
LINKSHIELD_X_FRAME_OPTIONS=DENY
LINKSHIELD_X_CONTENT_TYPE_OPTIONS=nosniff
LINKSHIELD_REFERRER_POLICY=strict-origin-when-cross-origin

# ========================================
# PHASE 3 SECURITY CONFIGURATION
# ========================================
# Advanced security features including notifications, secure logging,
# audit storage, error handling, and security event management

# Security Notification Settings (Phase 3 Security Enhancement)
# SECURITY CRITICAL: SMTP configuration for security-related email notifications
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_HOST=smtp.gmail.com
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_PORT=587
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_USERNAME=
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_PASSWORD=
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_USE_TLS=true
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_USE_SSL=false
LINKSHIELD_SECURITY_NOTIFICATION_SMTP_TIMEOUT=30
LINKSHIELD_SECURITY_NOTIFICATION_FROM_EMAIL=security@linkshield.com
LINKSHIELD_SECURITY_NOTIFICATION_FROM_NAME=LinkShield Security
LINKSHIELD_SECURITY_NOTIFICATION_REPLY_TO=noreply@linkshield.com
LINKSHIELD_SECURITY_NOTIFICATION_ADMIN_EMAIL=admin@linkshield.com
LINKSHIELD_SECURITY_NOTIFICATION_SECURITY_TEAM_EMAIL=security-team@linkshield.com
LINKSHIELD_SECURITY_NOTIFICATION_ENABLED=true
LINKSHIELD_SECURITY_NOTIFICATION_RATE_LIMIT_PER_HOUR=50
LINKSHIELD_SECURITY_NOTIFICATION_RATE_LIMIT_PER_DAY=200
LINKSHIELD_SECURITY_NOTIFICATION_RATE_LIMIT_BURST=10
LINKSHIELD_SECURITY_NOTIFICATION_QUEUE_SIZE=1000
LINKSHIELD_SECURITY_NOTIFICATION_RETRY_ATTEMPTS=3
LINKSHIELD_SECURITY_NOTIFICATION_RETRY_DELAY_SECONDS=60
LINKSHIELD_SECURITY_NOTIFICATION_TEMPLATE_PATH=templates/security/
LINKSHIELD_SECURITY_NOTIFICATION_INCLUDE_USER_AGENT=true
LINKSHIELD_SECURITY_NOTIFICATION_INCLUDE_IP_ADDRESS=true
LINKSHIELD_SECURITY_NOTIFICATION_INCLUDE_TIMESTAMP=true
LINKSHIELD_SECURITY_NOTIFICATION_ENCRYPT_SENSITIVE_DATA=true
LINKSHIELD_SECURITY_NOTIFICATION_WEBHOOK_ENABLED=false
LINKSHIELD_SECURITY_NOTIFICATION_WEBHOOK_URL=
LINKSHIELD_SECURITY_NOTIFICATION_WEBHOOK_SECRET=
LINKSHIELD_SECURITY_NOTIFICATION_WEBHOOK_TIMEOUT=10
LINKSHIELD_SECURITY_NOTIFICATION_SLACK_ENABLED=false
LINKSHIELD_SECURITY_NOTIFICATION_SLACK_WEBHOOK_URL=
LINKSHIELD_SECURITY_NOTIFICATION_SLACK_CHANNEL=#security-alerts

# Secure Logging Configuration (Phase 3 Security Enhancement)
# SECURITY CRITICAL: Log sanitization and PII protection settings
LINKSHIELD_SECURE_LOG_SANITIZATION_ENABLED=true
LINKSHIELD_SECURE_LOG_SANITIZATION_LEVEL=strict
LINKSHIELD_SECURE_LOG_PII_DETECTION_ENABLED=true
LINKSHIELD_SECURE_LOG_PII_PATTERNS=email,phone,ssn,credit_card
LINKSHIELD_SECURE_LOG_PII_REPLACEMENT_CHAR=*
LINKSHIELD_SECURE_LOG_PII_PRESERVE_FORMAT=true
LINKSHIELD_SECURE_LOG_REDACT_PASSWORDS=true
LINKSHIELD_SECURE_LOG_REDACT_TOKENS=true
LINKSHIELD_SECURE_LOG_REDACT_API_KEYS=true
LINKSHIELD_SECURE_LOG_REDACT_CREDIT_CARDS=true
LINKSHIELD_SECURE_LOG_REDACT_PHONE_NUMBERS=true
LINKSHIELD_SECURE_LOG_REDACT_EMAIL_ADDRESSES=false
LINKSHIELD_SECURE_LOG_REDACT_IP_ADDRESSES=false
LINKSHIELD_SECURE_LOG_REDACT_USER_AGENTS=false
LINKSHIELD_SECURE_LOG_ENCRYPTION_ENABLED=false
LINKSHIELD_SECURE_LOG_ENCRYPTION_KEY=
LINKSHIELD_SECURE_LOG_ENCRYPTION_ALGORITHM=AES-256-GCM
LINKSHIELD_SECURE_LOG_STORAGE_PATH=logs/secure/
LINKSHIELD_SECURE_LOG_ROTATION_ENABLED=true
LINKSHIELD_SECURE_LOG_ROTATION_SIZE_MB=100
LINKSHIELD_SECURE_LOG_ROTATION_COUNT=10
LINKSHIELD_SECURE_LOG_COMPRESSION_ENABLED=true
LINKSHIELD_SECURE_LOG_COMPRESSION_ALGORITHM=gzip
LINKSHIELD_SECURE_LOG_REMOTE_STORAGE_ENABLED=false
LINKSHIELD_SECURE_LOG_REMOTE_STORAGE_URL=
LINKSHIELD_SECURE_LOG_REMOTE_STORAGE_CREDENTIALS=
LINKSHIELD_SECURE_LOG_INTEGRITY_CHECK_ENABLED=true
LINKSHIELD_SECURE_LOG_INTEGRITY_HASH_ALGORITHM=SHA-256
LINKSHIELD_SECURE_LOG_BACKUP_ENABLED=true
LINKSHIELD_SECURE_LOG_BACKUP_INTERVAL_HOURS=24
LINKSHIELD_SECURE_LOG_BACKUP_RETENTION_DAYS=90

# Audit Logging Storage Configuration (Phase 3 Security Enhancement)
# SECURITY CRITICAL: Audit log retention and archival settings
LINKSHIELD_AUDIT_LOG_RETENTION_POLICY_ENABLED=true
LINKSHIELD_AUDIT_LOG_RETENTION_DAYS=2555
LINKSHIELD_AUDIT_LOG_RETENTION_CRITICAL_DAYS=3650
LINKSHIELD_AUDIT_LOG_RETENTION_HIGH_DAYS=1825
LINKSHIELD_AUDIT_LOG_RETENTION_MEDIUM_DAYS=1095
LINKSHIELD_AUDIT_LOG_RETENTION_LOW_DAYS=365
LINKSHIELD_AUDIT_LOG_ARCHIVAL_ENABLED=true
LINKSHIELD_AUDIT_LOG_ARCHIVAL_THRESHOLD_DAYS=365
LINKSHIELD_AUDIT_LOG_ARCHIVAL_STORAGE_PATH=archives/audit/
LINKSHIELD_AUDIT_LOG_ARCHIVAL_COMPRESSION_ENABLED=true
LINKSHIELD_AUDIT_LOG_ARCHIVAL_COMPRESSION_LEVEL=6
LINKSHIELD_AUDIT_LOG_ARCHIVAL_ENCRYPTION_ENABLED=true
LINKSHIELD_AUDIT_LOG_ARCHIVAL_ENCRYPTION_KEY=
LINKSHIELD_AUDIT_LOG_CLEANUP_ENABLED=true
LINKSHIELD_AUDIT_LOG_CLEANUP_INTERVAL_HOURS=24
LINKSHIELD_AUDIT_LOG_CLEANUP_BATCH_SIZE=1000
LINKSHIELD_AUDIT_LOG_CLEANUP_VERIFY_ARCHIVAL=true
LINKSHIELD_AUDIT_LOG_STORAGE_QUOTA_GB=100
LINKSHIELD_AUDIT_LOG_STORAGE_WARNING_THRESHOLD=80
LINKSHIELD_AUDIT_LOG_STORAGE_CRITICAL_THRESHOLD=95
LINKSHIELD_AUDIT_LOG_PERFORMANCE_MONITORING=true
LINKSHIELD_AUDIT_LOG_PERFORMANCE_SLOW_QUERY_MS=1000
LINKSHIELD_AUDIT_LOG_PERFORMANCE_BATCH_SIZE=500
LINKSHIELD_AUDIT_LOG_PERFORMANCE_QUEUE_SIZE=10000
LINKSHIELD_AUDIT_LOG_PERFORMANCE_WORKER_THREADS=4
LINKSHIELD_AUDIT_LOG_PERFORMANCE_MAX_MEMORY_MB=512
LINKSHIELD_AUDIT_LOG_INDEXING_ENABLED=true
LINKSHIELD_AUDIT_LOG_INDEXING_FIELDS=timestamp,user_id,action,resource
LINKSHIELD_AUDIT_LOG_INDEXING_REBUILD_INTERVAL_HOURS=168
LINKSHIELD_AUDIT_LOG_SEARCH_ENABLED=true
LINKSHIELD_AUDIT_LOG_SEARCH_MAX_RESULTS=1000
LINKSHIELD_AUDIT_LOG_SEARCH_TIMEOUT_SECONDS=30
LINKSHIELD_AUDIT_LOG_EXPORT_ENABLED=true
LINKSHIELD_AUDIT_LOG_EXPORT_MAX_RECORDS=100000
LINKSHIELD_AUDIT_LOG_EXPORT_TIMEOUT_MINUTES=30
LINKSHIELD_AUDIT_LOG_BULK_INSERT_ENABLED=true
LINKSHIELD_AUDIT_LOG_BULK_INSERT_BATCH_SIZE=100

# Error Handling Preferences (Phase 3 Security Enhancement)
# SECURITY CRITICAL: Error message sanitization and debug mode configuration
LINKSHIELD_ERROR_HANDLING_SANITIZATION_ENABLED=true
LINKSHIELD_ERROR_HANDLING_SANITIZATION_LEVEL=strict
LINKSHIELD_ERROR_HANDLING_SANITIZE_STACK_TRACES=true
LINKSHIELD_ERROR_HANDLING_SANITIZE_FILE_PATHS=true
LINKSHIELD_ERROR_HANDLING_SANITIZE_DATABASE_ERRORS=true
LINKSHIELD_ERROR_HANDLING_SANITIZE_NETWORK_ERRORS=true
LINKSHIELD_ERROR_HANDLING_SANITIZE_VALIDATION_ERRORS=false
LINKSHIELD_ERROR_HANDLING_GENERIC_MESSAGE=An error occurred while processing your request
LINKSHIELD_ERROR_HANDLING_INCLUDE_ERROR_ID=true
LINKSHIELD_ERROR_HANDLING_INCLUDE_TIMESTAMP=true
LINKSHIELD_ERROR_HANDLING_DEBUG_MODE_ENABLED=false
LINKSHIELD_ERROR_HANDLING_DEBUG_ALLOWED_IPS=
LINKSHIELD_ERROR_HANDLING_DEBUG_REQUIRE_AUTH=true
LINKSHIELD_ERROR_HANDLING_DEBUG_ADMIN_ONLY=true
LINKSHIELD_ERROR_HANDLING_DEBUG_INCLUDE_ENVIRONMENT=false
LINKSHIELD_ERROR_HANDLING_DEBUG_INCLUDE_REQUEST_DATA=false
LINKSHIELD_ERROR_HANDLING_DEBUG_MAX_STACK_DEPTH=10
LINKSHIELD_ERROR_HANDLING_LOG_ERRORS=true
LINKSHIELD_ERROR_HANDLING_LOG_LEVEL=ERROR
LINKSHIELD_ERROR_HANDLING_LOG_INCLUDE_USER_CONTEXT=true
LINKSHIELD_ERROR_HANDLING_LOG_INCLUDE_REQUEST_ID=true
LINKSHIELD_ERROR_HANDLING_EXTERNAL_REPORTING_ENABLED=false
LINKSHIELD_ERROR_HANDLING_SENTRY_DSN=
LINKSHIELD_ERROR_HANDLING_SENTRY_ENVIRONMENT=
LINKSHIELD_ERROR_HANDLING_SENTRY_SAMPLE_RATE=1.0
LINKSHIELD_ERROR_HANDLING_RATE_LIMITING_ENABLED=true
LINKSHIELD_ERROR_HANDLING_MAX_ERRORS_PER_MINUTE=100
LINKSHIELD_ERROR_HANDLING_CIRCUIT_BREAKER_ENABLED=true
LINKSHIELD_ERROR_HANDLING_CIRCUIT_BREAKER_FAILURE_THRESHOLD=50
LINKSHIELD_ERROR_HANDLING_CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60

# Security Event Configuration (Phase 3 Security Enhancement)
# SECURITY CRITICAL: Event detection thresholds and automated response settings
LINKSHIELD_SECURITY_EVENT_FAILED_LOGIN_THRESHOLD=5
LINKSHIELD_SECURITY_EVENT_FAILED_LOGIN_WINDOW_MINUTES=15
LINKSHIELD_SECURITY_EVENT_SUSPICIOUS_IP_THRESHOLD=10
LINKSHIELD_SECURITY_EVENT_RATE_LIMIT_THRESHOLD=100
LINKSHIELD_SECURITY_EVENT_PRIVILEGE_ESCALATION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_DATA_BREACH_DETECTION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_MALWARE_DETECTION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_ANOMALY_DETECTION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_GEOLOCATION_ANOMALY_ENABLED=true
LINKSHIELD_SECURITY_EVENT_SESSION_HIJACKING_DETECTION=true
LINKSHIELD_SECURITY_EVENT_SEVERITY_LEVELS=low,medium,high,critical
LINKSHIELD_SECURITY_EVENT_AUTO_ESCALATE_CRITICAL=true
LINKSHIELD_SECURITY_EVENT_AUTO_ESCALATE_HIGH=false
LINKSHIELD_SECURITY_EVENT_ESCALATION_DELAY_MINUTES=30
LINKSHIELD_SECURITY_EVENT_CORRELATION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_CORRELATION_WINDOW_MINUTES=60
LINKSHIELD_SECURITY_EVENT_DEDUPLICATION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_DEDUPLICATION_WINDOW_MINUTES=10
LINKSHIELD_SECURITY_EVENT_NOTIFICATION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_EMAIL_NOTIFICATIONS=true
LINKSHIELD_SECURITY_EVENT_SMS_NOTIFICATIONS=false
LINKSHIELD_SECURITY_EVENT_WEBHOOK_NOTIFICATIONS=false
LINKSHIELD_SECURITY_EVENT_SLACK_NOTIFICATIONS=false
LINKSHIELD_SECURITY_EVENT_NOTIFICATION_RATE_LIMIT=10
LINKSHIELD_SECURITY_EVENT_NOTIFICATION_COOLDOWN_MINUTES=5
LINKSHIELD_SECURITY_EVENT_EMERGENCY_CONTACT_LIST=
LINKSHIELD_SECURITY_EVENT_ESCALATION_CONTACT_LIST=
LINKSHIELD_SECURITY_EVENT_AUTO_BLOCK_ENABLED=true
LINKSHIELD_SECURITY_EVENT_AUTO_BLOCK_DURATION_MINUTES=60
LINKSHIELD_SECURITY_EVENT_AUTO_QUARANTINE_ENABLED=false
LINKSHIELD_SECURITY_EVENT_AUTO_LOGOUT_SUSPICIOUS_SESSIONS=true
LINKSHIELD_SECURITY_EVENT_AUTO_DISABLE_COMPROMISED_ACCOUNTS=true
LINKSHIELD_SECURITY_EVENT_INCIDENT_CREATION_ENABLED=true
LINKSHIELD_SECURITY_EVENT_FORENSIC_DATA_COLLECTION=true
LINKSHIELD_SECURITY_EVENT_BACKUP_TRIGGER_ENABLED=false